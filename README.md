### 1. 程序设计方案

#### 1.1 数据处理模块

**步骤 1: 重力加速度旋转和扣除**

- **输入**：IMU传感器的加速度数据、姿态数据（欧拉角）
- **处理**：
  - 将加速度数据从传感器坐标系转换到地球坐标系（东北天坐标系）。
  - 使用姿态数据计算重力加速度在传感器坐标系下的向量。
  - 从传感器加速度中扣除重力加速度分量，得到动态加速度。

**步骤 2: 零速度更新(ZVU)算法**

- **输入**：动态加速度数据、角速度数据（使用四元数的精度会更高，前期可以先用掌握的更熟悉一些的欧拉角来解决算法问题，后期再提高精度）
- **处理**：
  - 在一定时间内检查加速度和角速度的阈值。
  - 确定设备静止时刻，并标记这些时刻的速度为零。

**步骤 3: 计算速度和位移**

- **输入**：经过ZVU算法处理的动态加速度数据
- **处理**：
  - 对加速度数据积分得到速度，并在ZVU算法标记的静止时刻将速度置零。
  - 对速度数据积分得到位移。

#### 1.2 用户界面设计

- **主界面**：
  - 显示当前速度和位移的实时数据。
  - 图表显示速度-时间曲线和位移-时间曲线。
  - 按钮用于保存数据和配置蓝牙连接。

- **数据管理界面**：
  - 列表显示已保存的数据集。
  - 提供搜索和筛选功能。

- **蓝牙配置界面**：
  - 显示附近可发现的蓝牙设备。
  - 提供配对按钮和已配对设备列表。

#### 1.3 蓝牙连接模块

- **功能**：
  - 搜索附近的蓝牙设备。
  - 与指定蓝牙设备配对。
  - 通过蓝牙接收IMU传感器的数据。

- **实现**：
  - 使用.NET的`System.Device.Bluetooth`库进行蓝牙设备的搜索和连接。
  - 使用异步IO接收传感器数据。

#### 1.4 数据存储模块

- **存储介质**：
  - SQLite数据库用于存储传感器数据和应用程序配置。

- **功能**：
  - 保存和检索IMU传感器数据。
  - 维护用户配置（如蓝牙设备信息、数据保存路径等）。

- **实现**：
  - 使用Entity Framework Core或ADO.NET进行数据库操作。

### 2. 开发步骤

1. **设置开发环境**：安装Visual Studio，创建WinForms项目。
2. **实现数据处理模块**：编写算法转换坐标、扣除重力加速度、实现ZVU算法和积分计算。
3. **设计用户界面**：使用WinForms设计主界面和子界面。
4. **实现蓝牙连接模块**：编写蓝牙搜索、配对和接收数据的代码。
5. **实现数据存储模块**：设计数据库模型，实现数据存取逻辑。
6. **集成和测试**：集成所有模块，进行系统测试，确保各模块协同工作正常。

### 3. 注意事项

- **数据同步**：确保蓝牙接收到的数据能够实时或接近实时地处理并显示在UI上。
- **性能优化**：对大量数据处理时，考虑使用多线程或异步处理来提高应用程序的响应性和性能。
- **错误处理**：增加适当的错误处理逻辑，如蓝牙连接失败、数据解析错误等。
